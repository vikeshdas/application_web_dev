version: '3'

services:
  backend_service:
    image: timbba_django
    container_name: backend_service
    # depends_on:
    #   - cloudsql_proxy
    ports:
      - "8001:8001"
    volumes:
      - "./application_default_credentials.json:/application_default_credentials.json"
      - "./:/timbba_django"
    environment:
      - GOOGLE_APPLICATION_CREDENTIALS=/timbba_django/application_default_credentials.json 


  cloudsql_proxy:
    image: cloud_sql_proxy
    container_name: cloudsql_proxy
    ports:
        - "127.0.0.1:3307:3307"  
    volumes:
      - "./application_default_credentials.json:/application_default_credentials.json"

  # master_service:
  #     image: locust_image
  #     ports:
  #     - "8089:8089"
  #     volumes:
  #       - "./locustfile.py:/loat_testing/locustfile.py"
  #     command: -f /loat_testing/locustfile.py --master -H http://master_service:8089
    
  # worker_service:
  #   image: locust_image
  #   volumes:
  #     - "./locustfile.py:/loat_testing/locustfile.py"
  #   command: -f /loat_testing/locustfile.py --worker --master-host master_service